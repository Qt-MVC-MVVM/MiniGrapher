## Algorithm, Model & ViewModel 设计报告

### 1.模块设计简介

#### Algorithm

​	Algorithm层主要负责将字符串格式的函数处理成抽象函数，使得每给定一个x，能够输出一个值f(x)。

 * 设计思路

   在处理函数表达式的时候，我们需要将函数表达式解析为中缀树的形式来方便计算。因此需要分离变量、常数、计算符、函数等关键词，进而构建中缀树。

* 设计类

  * 中缀树节点类

    中缀树节点分为函数、常数、变量、操作符四种，分别提供计算函数，可以递归求解当前中缀树的值。

  * 解析器类

    解析器主要将输入字符串解析，并构造中缀树。即用变量栈和操作符栈两个栈进行处理，最终在变量栈中剩下唯一的一个节点，即为树的根节点。

    解析器类对上提供计算函数值、微分、积分的函数接口，对下调用树节点进行操作。

#### Model

​	Model层主要负责数据的处理、计算部分，其下属Algorithm层。

* 设计思路

  Model层主要处理数据，由于词法解析分离给了算法层，因此model层仅仅需要调用算法层计算，然后将得到的值返回给上一层即可。

* 设计类

  * Model类

    Model类主要提供范围内求值、微积分功能，返回Vector类坐标以绘图。

#### ViewModel

​	ViewModel层主要司职给Model层下达计算指令，计算完毕后收取Model层信号并发送信号给View层通知更新。

* 设计思路

  ViewModel在本项目中没有太多功能，仅仅需要提供向下对Model的Command指令，和接受Model信号并转发的Sink部分。

* Command类

  * PaintCommand

    给定一个字符串和定义域，给出其在定义域上的值，以Vector指针形式返回值。

  * CalculusCommand

    主要负责对某区间上的微分、积分运算。

* Sink类

  * 这里的接收器对于信号不做任何处理，即直接转发。
  
### 2.模块总结

​	本模块功能主要集中在算法层对于字符串的解析部分，Model层、ViewModel层仅仅是将命令、运算结果进行转发。主要难点即为前缀树的建立，以及模块间的通信问题。

### 3.心得

*  本次短学期主要学习到了MVVM的编程模式，各个模块相互独立，这一优异的特性使得整个项目能够并行化进行。
* GitHub和appveyor的使用帮助项目工程持续集成，以便及时发现其错误。
* 团队协作中各模块的解耦非常重要